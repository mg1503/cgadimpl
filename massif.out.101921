desc: (none)
cmd: ./cgadimpl/build/test_checkpoint
time_unit: i
#-----------
snapshot=0
#-----------
time=0
mem_heap_B=0
mem_heap_extra_B=0
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=1
#-----------
time=74071628478
mem_heap_B=840967459
mem_heap_extra_B=906701
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=2
#-----------
time=137448421457
mem_heap_B=850953411
mem_heap_extra_B=907789
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=3
#-----------
time=217119622506
mem_heap_B=866691691
mem_heap_extra_B=909109
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=4
#-----------
time=265284119689
mem_heap_B=878757963
mem_heap_extra_B=910133
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=5
#-----------
time=344565179251
mem_heap_B=891872939
mem_heap_extra_B=911221
mem_stacks_B=0
heap_tree=detailed
n2: 891872939 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 891060224 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n2: 471220224 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 445530112 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 235085824 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n2: 235085824 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n0: 25165824 in 3 places, all below massif's threshold (1.00%)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
   n0: 25690112 in 4 places, all below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 812715 in 64 places, all below massif's threshold (1.00%)
#-----------
snapshot=6
#-----------
time=376758729038
mem_heap_B=900791555
mem_heap_extra_B=911981
mem_stacks_B=0
heap_tree=detailed
n2: 900791555 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 899973120 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 480133120 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 450248704 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 239804416 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n4: 239804416 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 9961472 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 9961472 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 9961472 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 9961472 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 9961472 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 9961472 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 9961472 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 9961472 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 9961472 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 9961472 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n1: 9961472 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 9961472 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                  n0: 9961472 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 9961472 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 9961472 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 9961472 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 9961472 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 9961472 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 9961472 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 9961472 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 9961472 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 9961472 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n1: 9961472 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 9961472 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 9961472 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 9961472 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 9961472 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 9961472 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 9961472 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 9961472 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 9961472 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 9961472 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 9961472 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 9961472 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n1: 9961472 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 9961472 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 9961472 0x2F85C5: main (test_checkpoint.cpp:259)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
   n2: 9961472 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 9961472 0x3495D2: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:19)
     n1: 9961472 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
      n1: 9961472 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
       n1: 9961472 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
        n1: 9961472 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 9961472 0x2F85C5: main (test_checkpoint.cpp:259)
    n0: 0 in 1 place, below massif's threshold (1.00%)
   n1: 9961472 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 9961472 0x34A9A6: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:145)
     n1: 9961472 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
      n1: 9961472 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
       n1: 9961472 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
        n0: 9961472 0x2F85C5: main (test_checkpoint.cpp:259)
   n1: 9961472 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 9961472 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 9961472 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 9961472 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n1: 9961472 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 9961472 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 9961472 0x2F85C5: main (test_checkpoint.cpp:259)
   n0: 0 in 1 place, below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 818435 in 64 places, all below massif's threshold (1.00%)
#-----------
snapshot=7
#-----------
time=440227325448
mem_heap_B=911808179
mem_heap_extra_B=912933
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=8
#-----------
time=472360050370
mem_heap_B=919677491
mem_heap_extra_B=913565
mem_stacks_B=0
heap_tree=detailed
n2: 919677491 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 918847488 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 499007488 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 459685888 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 249241600 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n4: 249241600 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 13107200 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 13107200 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 13107200 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 13107200 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 13107200 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 13107200 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 13107200 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 13107200 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 13107200 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 13107200 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n1: 13107200 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 13107200 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                  n0: 13107200 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 13107200 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 13107200 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 13107200 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 13107200 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 13107200 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 13107200 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 13107200 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 13107200 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 13107200 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n1: 13107200 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 13107200 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 13107200 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 13107200 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 13107200 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 13107200 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 13107200 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 13107200 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 13107200 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 13107200 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 13107200 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 13107200 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n1: 13107200 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 13107200 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 13107200 0x2F85C5: main (test_checkpoint.cpp:259)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
   n2: 13107200 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 13107200 0x3495D2: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:19)
     n1: 13107200 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
      n1: 13107200 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
       n1: 13107200 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
        n1: 13107200 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 13107200 0x2F85C5: main (test_checkpoint.cpp:259)
    n0: 0 in 1 place, below massif's threshold (1.00%)
   n1: 13107200 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 13107200 0x34A9A6: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:145)
     n1: 13107200 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
      n1: 13107200 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
       n1: 13107200 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
        n0: 13107200 0x2F85C5: main (test_checkpoint.cpp:259)
   n1: 13107200 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 13107200 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 13107200 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 13107200 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n1: 13107200 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 13107200 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 13107200 0x2F85C5: main (test_checkpoint.cpp:259)
   n0: 0 in 1 place, below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 830003 in 64 places, all below massif's threshold (1.00%)
#-----------
snapshot=9
#-----------
time=535882652797
mem_heap_B=931218939
mem_heap_extra_B=914557
mem_stacks_B=0
heap_tree=detailed
n2: 931218939 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 930381824 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 510541824 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 465453056 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 255008768 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n4: 255008768 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 15204352 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 15204352 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 15204352 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 15204352 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 15204352 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 15204352 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 15204352 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 15204352 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 15204352 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 15204352 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n1: 15204352 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 15204352 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                  n0: 15204352 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 15204352 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 15204352 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 15204352 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 15204352 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 15204352 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 15204352 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 15204352 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 15204352 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 15204352 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n1: 15204352 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 15204352 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 15204352 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 14680064 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 14680064 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 14680064 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 14680064 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 14680064 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 14680064 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 14680064 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 14680064 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 14680064 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n1: 14680064 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 14680064 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 14680064 0x2F85C5: main (test_checkpoint.cpp:259)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
   n2: 15204352 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 15204352 0x3495D2: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:19)
     n1: 15204352 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
      n1: 15204352 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
       n1: 15204352 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
        n1: 15204352 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 15204352 0x2F85C5: main (test_checkpoint.cpp:259)
    n0: 0 in 1 place, below massif's threshold (1.00%)
   n1: 15204352 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 15204352 0x34A9A6: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:145)
     n1: 15204352 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
      n1: 15204352 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
       n1: 15204352 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
        n0: 15204352 0x2F85C5: main (test_checkpoint.cpp:259)
   n1: 14680064 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 14680064 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 14680064 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 14680064 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n1: 14680064 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 14680064 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 14680064 0x2F85C5: main (test_checkpoint.cpp:259)
   n0: 0 in 1 place, below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 837115 in 64 places, all below massif's threshold (1.00%)
#-----------
snapshot=10
#-----------
time=567927338226
mem_heap_B=938563427
mem_heap_extra_B=915149
mem_stacks_B=0
heap_tree=detailed
n2: 938563427 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 937721856 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 517881856 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 469123072 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 258678784 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n4: 258678784 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 16252928 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 16252928 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 16252928 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 16252928 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 16252928 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 16252928 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 16252928 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 16252928 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 16252928 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 16252928 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n1: 16252928 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 16252928 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                  n0: 16252928 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 16252928 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 16252928 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 16252928 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 16252928 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 16252928 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 16252928 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 16252928 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 16252928 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 16252928 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n1: 16252928 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 16252928 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 16252928 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 16252928 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 16252928 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 16252928 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 16252928 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 16252928 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 16252928 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 16252928 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 16252928 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 16252928 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n1: 16252928 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 16252928 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 16252928 0x2F85C5: main (test_checkpoint.cpp:259)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
   n2: 16252928 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 16252928 0x3495D2: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:19)
     n1: 16252928 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
      n1: 16252928 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
       n1: 16252928 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
        n1: 16252928 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 16252928 0x2F85C5: main (test_checkpoint.cpp:259)
    n0: 0 in 1 place, below massif's threshold (1.00%)
   n1: 16252928 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 16252928 0x34A9A6: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:145)
     n1: 16252928 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
      n1: 16252928 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
       n1: 16252928 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
        n0: 16252928 0x2F85C5: main (test_checkpoint.cpp:259)
   n1: 16252928 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 16252928 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 16252928 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 16252928 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n1: 16252928 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 16252928 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 16252928 0x2F85C5: main (test_checkpoint.cpp:259)
   n0: 0 in 1 place, below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 841571 in 64 places, all below massif's threshold (1.00%)
#-----------
snapshot=11
#-----------
time=631473219389
mem_heap_B=950104875
mem_heap_extra_B=916141
mem_stacks_B=0
heap_tree=detailed
n2: 950104875 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 949256192 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 529416192 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 474890240 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 264445952 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n4: 264445952 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 18350080 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 18350080 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 18350080 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 18350080 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 18350080 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 18350080 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 18350080 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 18350080 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 18350080 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 18350080 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n1: 18350080 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 18350080 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                  n0: 18350080 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 18350080 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 18350080 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 18350080 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 18350080 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 18350080 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 18350080 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 18350080 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 18350080 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 18350080 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n1: 18350080 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 18350080 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 18350080 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 17825792 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 17825792 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 17825792 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 17825792 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 17825792 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 17825792 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 17825792 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 17825792 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 17825792 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n1: 17825792 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 17825792 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 17825792 0x2F85C5: main (test_checkpoint.cpp:259)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
   n2: 18350080 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 18350080 0x3495D2: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:19)
     n1: 18350080 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
      n1: 18350080 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
       n1: 18350080 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
        n1: 18350080 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 18350080 0x2F85C5: main (test_checkpoint.cpp:259)
    n0: 0 in 1 place, below massif's threshold (1.00%)
   n1: 18350080 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 18350080 0x34A9A6: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:145)
     n1: 18350080 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
      n1: 18350080 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
       n1: 18350080 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
        n0: 18350080 0x2F85C5: main (test_checkpoint.cpp:259)
   n1: 17825792 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 17825792 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 17825792 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 17825792 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n1: 17825792 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 17825792 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 17825792 0x2F85C5: main (test_checkpoint.cpp:259)
   n0: 0 in 1 place, below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 848683 in 64 places, all below massif's threshold (1.00%)
#-----------
snapshot=12
#-----------
time=695081537800
mem_heap_B=961121371
mem_heap_extra_B=917029
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=13
#-----------
time=727228668473
mem_heap_B=970039563
mem_heap_extra_B=917805
mem_stacks_B=0
heap_tree=detailed
n2: 970039563 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 969179136 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 549339136 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 484327424 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 273883136 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n4: 273883136 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 21495808 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 21495808 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 21495808 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 21495808 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 21495808 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 21495808 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 21495808 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 21495808 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 21495808 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 21495808 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n1: 21495808 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 21495808 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                  n0: 21495808 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 21495808 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 21495808 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 21495808 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 21495808 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 21495808 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 21495808 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 21495808 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 21495808 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 21495808 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n1: 21495808 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 21495808 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 21495808 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 20971520 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 20971520 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 20971520 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 20971520 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 20971520 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 20971520 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 20971520 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 20971520 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 20971520 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n1: 20971520 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 20971520 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 20971520 0x2F85C5: main (test_checkpoint.cpp:259)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
   n2: 22020096 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 21495808 0x3495D2: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:19)
     n1: 21495808 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
      n1: 21495808 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
       n1: 21495808 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
        n1: 21495808 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 21495808 0x2F85C5: main (test_checkpoint.cpp:259)
    n0: 524288 in 1 place, below massif's threshold (1.00%)
   n1: 21495808 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 21495808 0x34A9A6: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:145)
     n1: 21495808 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
      n1: 21495808 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
       n1: 21495808 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
        n0: 21495808 0x2F85C5: main (test_checkpoint.cpp:259)
   n1: 20971520 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 20971520 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 20971520 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 20971520 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n1: 20971520 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 20971520 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 20971520 0x2F85C5: main (test_checkpoint.cpp:259)
   n0: 524288 in 1 place, below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 860427 in 64 places, all below massif's threshold (1.00%)
#-----------
snapshot=14
#-----------
time=790678350590
mem_heap_B=980007307
mem_heap_extra_B=918613
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=15
#-----------
time=838436617055
mem_heap_B=989975179
mem_heap_extra_B=919485
mem_stacks_B=0
heap_tree=peak
n2: 989975179 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 989102080 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 569262080 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 494813184 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 284368896 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n4: 284368896 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 25165824 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 25165824 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 25165824 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 25165824 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 25165824 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 25165824 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 25165824 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 25165824 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 25165824 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n1: 25165824 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 25165824 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 25165824 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 24641536 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 24641536 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 24641536 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 24641536 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 24641536 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 24641536 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 24641536 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 24641536 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 24641536 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 24641536 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n1: 24641536 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 24641536 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                  n0: 24641536 0x2F85C5: main (test_checkpoint.cpp:259)
      n1: 24641536 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 24641536 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 24641536 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 24641536 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 24641536 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 24641536 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 24641536 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 24641536 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 24641536 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n1: 24641536 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 24641536 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
                 n0: 24641536 0x2F85C5: main (test_checkpoint.cpp:259)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
   n1: 25165824 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 25165824 0x34A9A6: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:145)
     n1: 25165824 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
      n1: 25165824 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
       n1: 25165824 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
        n0: 25165824 0x2F85C5: main (test_checkpoint.cpp:259)
   n2: 24641536 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 24641536 0x3495D2: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:19)
     n1: 24641536 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
      n1: 24641536 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
       n1: 24641536 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
        n1: 24641536 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 24641536 0x2F85C5: main (test_checkpoint.cpp:259)
    n0: 0 in 1 place, below massif's threshold (1.00%)
   n1: 24641536 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 24641536 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 24641536 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 24641536 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n1: 24641536 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 24641536 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:166)
         n0: 24641536 0x2F85C5: main (test_checkpoint.cpp:259)
   n0: 0 in 1 place, below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 873099 in 64 places, all below massif's threshold (1.00%)
#-----------
snapshot=16
#-----------
time=902206223496
mem_heap_B=844658099
mem_heap_extra_B=907261
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=17
#-----------
time=965890586947
mem_heap_B=857248755
mem_heap_extra_B=908349
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=18
#-----------
time=1045948606310
mem_heap_B=875610371
mem_heap_extra_B=909917
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=19
#-----------
time=1109320997092
mem_heap_B=885577723
mem_heap_extra_B=910757
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=20
#-----------
time=1157085905194
mem_heap_B=895020723
mem_heap_extra_B=911565
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=21
#-----------
time=1220798851872
mem_heap_B=907611379
mem_heap_extra_B=912637
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=22
#-----------
time=1268636503314
mem_heap_B=917054363
mem_heap_extra_B=913437
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=23
#-----------
time=1348241675107
mem_heap_B=932792691
mem_heap_extra_B=914781
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=24
#-----------
time=1396039511500
mem_heap_B=942235675
mem_heap_extra_B=915581
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=25
#-----------
time=1443795173157
mem_heap_B=951678675
mem_heap_extra_B=916389
mem_stacks_B=0
heap_tree=detailed
n2: 951678675 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 950829056 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 530989056 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 475414528 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 264970240 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n4: 264970240 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 18350080 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 18350080 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 18350080 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 18350080 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 18350080 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 18350080 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 18350080 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 18350080 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 18350080 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 18350080 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 18350080 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 18350080 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                  n0: 18350080 0x2F85C5: main (test_checkpoint.cpp:259)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 18350080 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 18350080 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 18350080 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 18350080 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 18350080 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 18350080 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 18350080 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 18350080 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 18350080 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 18350080 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 18350080 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 18350080 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 18350080 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 18350080 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 18350080 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 18350080 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 18350080 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 18350080 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 18350080 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 18350080 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 18350080 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 18350080 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 18350080 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 18350080 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
   n1: 18874368 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 18874368 0x34A9A6: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:145)
     n1: 18874368 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
      n2: 18874368 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
       n1: 18874368 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
        n0: 18874368 0x2F85C5: main (test_checkpoint.cpp:259)
       n0: 0 in 1 place, below massif's threshold (1.00%)
   n2: 18350080 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 18350080 0x3495D2: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:19)
     n1: 18350080 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
      n1: 18350080 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
       n2: 18350080 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
        n1: 18350080 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
         n0: 18350080 0x2F85C5: main (test_checkpoint.cpp:259)
        n0: 0 in 1 place, below massif's threshold (1.00%)
    n0: 0 in 1 place, below massif's threshold (1.00%)
   n1: 18350080 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 18350080 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 18350080 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 18350080 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n2: 18350080 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 18350080 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
         n0: 18350080 0x2F85C5: main (test_checkpoint.cpp:259)
        n0: 0 in 1 place, below massif's threshold (1.00%)
   n0: 0 in 1 place, below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 849619 in 68 places, all below massif's threshold (1.00%)
#-----------
snapshot=26
#-----------
time=1507572333644
mem_heap_B=964269331
mem_heap_extra_B=917461
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=27
#-----------
time=1555343489309
mem_heap_B=973712315
mem_heap_extra_B=918261
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=28
#-----------
time=1603171853351
mem_heap_B=983155315
mem_heap_extra_B=919069
mem_stacks_B=0
heap_tree=detailed
n2: 983155315 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 982286336 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 562446336 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 491143168 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 280698880 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n4: 280698880 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 23592960 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 23592960 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 23592960 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 23592960 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 23592960 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 23592960 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 23592960 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 23592960 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 23592960 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 23592960 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 23592960 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 23592960 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                  n0: 23592960 0x2F85C5: main (test_checkpoint.cpp:259)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 23592960 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 23592960 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 23592960 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 23592960 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 23592960 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 23592960 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 23592960 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 23592960 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 23592960 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 23592960 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 23592960 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 23592960 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 23592960 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 23592960 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 23592960 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 23592960 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 23592960 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 23592960 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 23592960 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 23592960 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 23592960 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 23592960 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 23592960 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 23592960 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
   n1: 24117248 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 24117248 0x34A9A6: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:145)
     n1: 24117248 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
      n2: 24117248 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
       n1: 24117248 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
        n0: 24117248 0x2F85C5: main (test_checkpoint.cpp:259)
       n0: 0 in 1 place, below massif's threshold (1.00%)
   n2: 23592960 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 23592960 0x3495D2: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:19)
     n1: 23592960 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
      n1: 23592960 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
       n2: 23592960 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
        n1: 23592960 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
         n0: 23592960 0x2F85C5: main (test_checkpoint.cpp:259)
        n0: 0 in 1 place, below massif's threshold (1.00%)
    n0: 0 in 1 place, below massif's threshold (1.00%)
   n1: 23592960 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 23592960 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 23592960 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 23592960 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n2: 23592960 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 23592960 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
         n0: 23592960 0x2F85C5: main (test_checkpoint.cpp:259)
        n0: 0 in 1 place, below massif's threshold (1.00%)
   n0: 0 in 1 place, below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 868979 in 68 places, all below massif's threshold (1.00%)
#-----------
snapshot=29
#-----------
time=1666878019694
mem_heap_B=995745971
mem_heap_extra_B=920141
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=30
#-----------
time=1699722703712
mem_heap_B=934408139
mem_heap_extra_B=917981
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=31
#-----------
time=1747033347970
mem_heap_B=935981955
mem_heap_extra_B=918173
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=32
#-----------
time=1795198333385
mem_heap_B=937031179
mem_heap_extra_B=918301
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=33
#-----------
time=1874210733506
mem_heap_B=943324235
mem_heap_extra_B=922653
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=34
#-----------
time=1922116483843
mem_heap_B=939654211
mem_heap_extra_B=918621
mem_stacks_B=0
heap_tree=detailed
n2: 939654211 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 938770560 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n3: 518930560 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n3: 499007616 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 288563200 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n5: 288563200 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 26214400 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 26214400 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 26214400 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 26214400 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 26214400 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 26214400 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 26214400 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 26214400 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 26214400 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                  n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 26214400 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 26214400 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 26214400 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 26214400 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 26214400 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 26214400 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 26214400 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 26214400 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 26214400 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 26214400 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 26214400 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 26214400 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 26214400 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 26214400 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 26214400 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 26214400 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
    n0: 128 in 2 places, all below massif's threshold (1.00%)
   n1: 14155776 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n2: 14155776 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 13107200 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 13107200 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n2: 13107200 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 13107200 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
         n0: 13107200 0x2F85C5: main (test_checkpoint.cpp:259)
        n0: 0 in 1 place, below massif's threshold (1.00%)
     n0: 1048576 in 2 places, all below massif's threshold (1.00%)
   n0: 5767168 in 6 places, all below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 883651 in 72 places, all below massif's threshold (1.00%)
#-----------
snapshot=35
#-----------
time=1969625171348
mem_heap_B=945947531
mem_heap_extra_B=922941
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=36
#-----------
time=2033291744294
mem_heap_B=943851331
mem_heap_extra_B=919101
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=37
#-----------
time=2081427563338
mem_heap_B=944900555
mem_heap_extra_B=919261
mem_stacks_B=0
heap_tree=detailed
n2: 944900555 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 944013440 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n3: 524173440 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n3: 499007616 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 288563200 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n5: 288563200 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 26214400 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 26214400 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 26214400 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 26214400 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 26214400 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 26214400 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 26214400 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 26214400 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 26214400 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                  n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 26214400 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 26214400 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 26214400 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 26214400 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 26214400 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 26214400 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 26214400 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 26214400 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 26214400 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 26214400 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 26214400 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 26214400 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 26214400 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 26214400 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 26214400 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 26214400 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
    n0: 128 in 2 places, all below massif's threshold (1.00%)
   n1: 15204352 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n2: 15204352 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 13107200 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 13107200 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n2: 13107200 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 13107200 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
         n0: 13107200 0x2F85C5: main (test_checkpoint.cpp:259)
        n0: 0 in 1 place, below massif's threshold (1.00%)
     n0: 2097152 in 2 places, all below massif's threshold (1.00%)
   n0: 9961472 in 6 places, all below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 887115 in 72 places, all below massif's threshold (1.00%)
#-----------
snapshot=38
#-----------
time=2128749334381
mem_heap_B=946474371
mem_heap_extra_B=919453
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=39
#-----------
time=2176885910226
mem_heap_B=947523595
mem_heap_extra_B=919581
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=40
#-----------
time=2224126688690
mem_heap_B=949097891
mem_heap_extra_B=919757
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=41
#-----------
time=2272266822181
mem_heap_B=950147115
mem_heap_extra_B=919885
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=42
#-----------
time=2319586525275
mem_heap_B=951720931
mem_heap_extra_B=920125
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=43
#-----------
time=2367737436120
mem_heap_B=952770155
mem_heap_extra_B=920317
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=44
#-----------
time=2414979480756
mem_heap_B=954343971
mem_heap_extra_B=920525
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=45
#-----------
time=2463133242471
mem_heap_B=955393195
mem_heap_extra_B=920685
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=46
#-----------
time=2510423504172
mem_heap_B=956967011
mem_heap_extra_B=920877
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=47
#-----------
time=2558606124337
mem_heap_B=958016235
mem_heap_extra_B=921037
mem_stacks_B=0
heap_tree=detailed
n2: 958016235 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 957120640 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 537280640 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n3: 499007616 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 288563200 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n5: 288563200 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 26214400 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 26214400 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 26214400 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 26214400 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 26214400 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 26214400 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 26214400 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 26214400 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 26214400 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                  n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 26214400 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 26214400 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 26214400 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 26214400 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 26214400 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 26214400 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 26214400 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 26214400 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 26214400 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 26214400 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 26214400 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 26214400 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 26214400 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 26214400 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 26214400 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 26214400 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
    n0: 128 in 2 places, all below massif's threshold (1.00%)
   n1: 17825792 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n2: 17825792 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 13107200 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 13107200 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n2: 13107200 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 13107200 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
         n0: 13107200 0x2F85C5: main (test_checkpoint.cpp:259)
        n0: 0 in 1 place, below massif's threshold (1.00%)
     n0: 4718592 in 2 places, all below massif's threshold (1.00%)
   n2: 10485760 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 9961472 0x32B9B2: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:361)
     n1: 9961472 0x32C85E: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n1: 9961472 0x30545B: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n1: 9961472 0x30517A: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
        n0: 9961472 in 2 places, all below massif's threshold (1.00%)
    n0: 524288 in 3 places, all below massif's threshold (1.00%)
   n2: 9961472 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 9961472 0x32B835: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:350)
     n1: 9961472 0x32C85E: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n1: 9961472 0x30545B: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n0: 9961472 in 2 places, all below massif's threshold (1.00%)
    n0: 0 in 4 places, all below massif's threshold (1.00%)
   n0: 0 in 4 places, all below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 895595 in 72 places, all below massif's threshold (1.00%)
#-----------
snapshot=48
#-----------
time=2637644663134
mem_heap_B=964309291
mem_heap_extra_B=925373
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=49
#-----------
time=2717452134033
mem_heap_B=963262315
mem_heap_extra_B=921725
mem_stacks_B=0
heap_tree=detailed
n2: 963262315 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 962363520 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 542523520 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n3: 499007616 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 288563200 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n5: 288563200 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 26214400 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 26214400 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 26214400 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 26214400 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 26214400 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 26214400 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 26214400 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 26214400 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 26214400 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                  n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 26214400 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 26214400 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 26214400 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 26214400 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 26214400 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 26214400 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 26214400 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 26214400 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 26214400 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 26214400 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 26214400 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 26214400 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 26214400 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 26214400 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 26214400 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 26214400 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
    n0: 128 in 2 places, all below massif's threshold (1.00%)
   n1: 18874368 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n2: 18874368 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 13107200 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 13107200 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n2: 13107200 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 13107200 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
         n0: 13107200 0x2F85C5: main (test_checkpoint.cpp:259)
        n0: 0 in 1 place, below massif's threshold (1.00%)
     n0: 5767168 in 2 places, all below massif's threshold (1.00%)
   n2: 12582912 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 12058624 0x32B9B2: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:361)
     n1: 12058624 0x32C85E: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n1: 12058624 0x30545B: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n1: 12058624 0x30517A: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
        n0: 12058624 in 2 places, all below massif's threshold (1.00%)
    n0: 524288 in 3 places, all below massif's threshold (1.00%)
   n2: 12058624 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 12058624 0x32B835: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:350)
     n1: 12058624 0x32C85E: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n1: 12058624 0x30545B: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n0: 12058624 in 2 places, all below massif's threshold (1.00%)
    n0: 0 in 4 places, all below massif's threshold (1.00%)
   n0: 0 in 4 places, all below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 898795 in 72 places, all below massif's threshold (1.00%)
#-----------
snapshot=50
#-----------
time=2733099671471
mem_heap_B=966932331
mem_heap_extra_B=925757
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=51
#-----------
time=2749460515224
mem_heap_B=963262315
mem_heap_extra_B=921725
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=52
#-----------
time=2765108052662
mem_heap_B=966932331
mem_heap_extra_B=925757
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=53
#-----------
time=2780977312208
mem_heap_B=963262307
mem_heap_extra_B=921725
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=54
#-----------
time=2796739897486
mem_heap_B=964837219
mem_heap_extra_B=921949
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=55
#-----------
time=2812840041356
mem_heap_B=965886443
mem_heap_extra_B=922093
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=56
#-----------
time=2828487578794
mem_heap_B=969556459
mem_heap_extra_B=926125
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=57
#-----------
time=2844897500605
mem_heap_B=965886443
mem_heap_extra_B=922093
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=58
#-----------
time=2860549099114
mem_heap_B=969556459
mem_heap_extra_B=926125
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=59
#-----------
time=2876377589944
mem_heap_B=965886435
mem_heap_extra_B=922093
mem_stacks_B=0
heap_tree=detailed
n2: 965886435 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 964984960 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 545144960 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n3: 499007616 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 288563200 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n5: 288563200 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 26214400 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 26214400 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 26214400 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 26214400 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 26214400 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 26214400 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 26214400 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 26214400 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 26214400 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                  n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 26214400 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 26214400 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 26214400 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 26214400 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 26214400 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 26214400 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 26214400 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 26214400 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 26214400 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 26214400 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 26214400 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 26214400 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 26214400 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 26214400 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 26214400 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 26214400 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
    n0: 128 in 2 places, all below massif's threshold (1.00%)
   n1: 19398656 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n2: 19398656 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 13107200 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 13107200 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n2: 13107200 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 13107200 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
         n0: 13107200 0x2F85C5: main (test_checkpoint.cpp:259)
        n0: 0 in 1 place, below massif's threshold (1.00%)
     n0: 6291456 in 2 places, all below massif's threshold (1.00%)
   n2: 13631488 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 13631488 0x32B9B2: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:361)
     n1: 13631488 0x32C85E: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n1: 13631488 0x30545B: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n1: 13631488 0x30517A: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
        n0: 13631488 in 2 places, all below massif's threshold (1.00%)
    n0: 0 in 3 places, all below massif's threshold (1.00%)
   n2: 13107200 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 13107200 0x32B835: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:350)
     n1: 13107200 0x32C85E: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n1: 13107200 0x30545B: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n0: 13107200 in 2 places, all below massif's threshold (1.00%)
    n0: 0 in 4 places, all below massif's threshold (1.00%)
   n0: 0 in 4 places, all below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 901475 in 72 places, all below massif's threshold (1.00%)
#-----------
snapshot=60
#-----------
time=2892184383133
mem_heap_B=967460259
mem_heap_extra_B=922317
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=61
#-----------
time=2908255209533
mem_heap_B=968509483
mem_heap_extra_B=922461
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=62
#-----------
time=2923917535070
mem_heap_B=972179499
mem_heap_extra_B=926493
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=63
#-----------
time=2940336733815
mem_heap_B=968509483
mem_heap_extra_B=922461
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=64
#-----------
time=2955986346711
mem_heap_B=972179499
mem_heap_extra_B=926493
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=65
#-----------
time=2971864053647
mem_heap_B=968509475
mem_heap_extra_B=922461
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=66
#-----------
time=2987574913786
mem_heap_B=970083299
mem_heap_extra_B=922685
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=67
#-----------
time=3003751821781
mem_heap_B=971132523
mem_heap_extra_B=922829
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=68
#-----------
time=3019400470705
mem_heap_B=974802539
mem_heap_extra_B=926861
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=69
#-----------
time=3035746908067
mem_heap_B=971132523
mem_heap_extra_B=922829
mem_stacks_B=0
heap_tree=detailed
n2: 971132523 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 970227840 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 550387840 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n3: 499007616 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 288563200 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n5: 288563200 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x365C20: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 26214400 0x3638B5: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 26214400 0x3638B5: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 26214400 0x36087D: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 26214400 0x35EB55: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35D478: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 26214400 0x35C15A: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 26214400 0x34964C: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 26214400 0x32795F: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 26214400 0x2F9110: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 26214400 0x2F97EC: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                 n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                  n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x36622D: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 26214400 0x364031: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 26214400 0x364031: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 26214400 0x361757: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 26214400 0x35F47F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35DC88: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 26214400 0x35C510: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 26214400 0x34A767: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 26214400 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 26214400 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
                n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 26214400 0x366353: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 26214400 0x364161: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 26214400 0x364161: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 26214400 0x36191F: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 26214400 0x35F53F: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 26214400 0x35DD2C: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 26214400 0x35C5BF: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 26214400 0x34AA20: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 26214400 0x328731: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 26214400 0x2F97D6: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 26214400 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
                 n0: 26214400 0x2F85C5: main (test_checkpoint.cpp:259)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 210444288 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 729088 in 2 places, all below massif's threshold (1.00%)
    n0: 128 in 2 places, all below massif's threshold (1.00%)
   n1: 20447232 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n2: 20447232 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 13107200 0x34A6FA: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 13107200 0x3281A7: ag::relu(ag::Value const&) (ops.cpp:71)
       n2: 13107200 0x2F982A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:121)
        n1: 13107200 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:183)
         n0: 13107200 0x2F85C5: main (test_checkpoint.cpp:259)
        n0: 0 in 1 place, below massif's threshold (1.00%)
     n0: 7340032 in 2 places, all below massif's threshold (1.00%)
   n2: 15728640 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 15204352 0x32B9B2: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:361)
     n1: 15204352 0x32C85E: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n1: 15204352 0x30545B: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n1: 15204352 0x30517A: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
        n0: 15204352 in 2 places, all below massif's threshold (1.00%)
    n0: 524288 in 3 places, all below massif's threshold (1.00%)
   n2: 15204352 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 15204352 0x32B835: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:350)
     n1: 15204352 0x32C85E: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n1: 15204352 0x30545B: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n0: 15204352 in 2 places, all below massif's threshold (1.00%)
    n0: 0 in 4 places, all below massif's threshold (1.00%)
   n0: 0 in 4 places, all below massif's threshold (1.00%)
  n1: 419840000 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 419840000 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 209920000 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 209920000 0x32652C: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 209920000 0x2FEB6C: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 209920000 0x2FDAFD: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 209920000 0x2FDAFD: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 209920000 0x2FCFD5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 209920000 0x2FBFD3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 209920000 0x2FB334: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 209920000 0x2FA66C: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 209920000 0x2F8F4C: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 209715200 0x2F93E4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
               n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
                n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
              n0: 204800 in 1 place, below massif's threshold (1.00%)
    n2: 209920000 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 209715200 0x2F93C4: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:112)
      n1: 209715200 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:157)
       n0: 209715200 0x2F85C5: main (test_checkpoint.cpp:259)
     n0: 204800 in 1 place, below massif's threshold (1.00%)
 n0: 904683 in 72 places, all below massif's threshold (1.00%)
#-----------
snapshot=70
#-----------
time=3051409178591
mem_heap_B=974802539
mem_heap_extra_B=926861
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=71
#-----------
time=3067278623556
mem_heap_B=971132515
mem_heap_extra_B=922829
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=72
#-----------
time=3083031074671
mem_heap_B=972706339
mem_heap_extra_B=923053
mem_stacks_B=0
heap_tree=empty
