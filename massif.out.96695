desc: (none)
cmd: ./cgadimpl/build/test_checkpoint
time_unit: i
#-----------
snapshot=0
#-----------
time=0
mem_heap_B=0
mem_heap_extra_B=0
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=1
#-----------
time=3710031116
mem_heap_B=44828923
mem_heap_extra_B=91341
mem_stacks_B=0
heap_tree=detailed
n2: 44828923 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 44122112 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n1: 22061056 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 22061056 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n2: 11554816 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 11534336 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 11534336 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 11534336 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 20480 in 1 place, below massif's threshold (1.00%)
    n1: 10506240 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 10506240 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 10506240 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 10506240 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 10506240 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 10506240 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 10506240 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 10506240 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 10506240 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 10506240 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 10485760 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 10485760 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 10485760 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 20480 in 1 place, below massif's threshold (1.00%)
  n1: 22061056 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 22061056 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n2: 11554816 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 11534336 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 11534336 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 11534336 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 20480 in 1 place, below massif's threshold (1.00%)
    n1: 10506240 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 10506240 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 10506240 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 10506240 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 10506240 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 10506240 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 10506240 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 10506240 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 10506240 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 10506240 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 10485760 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 10485760 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 10485760 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 20480 in 1 place, below massif's threshold (1.00%)
 n0: 706811 in 59 places, all below massif's threshold (1.00%)
#-----------
snapshot=2
#-----------
time=9604366266
mem_heap_B=85709331
mem_heap_extra_B=94157
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=3
#-----------
time=13801333514
mem_heap_B=87286051
mem_heap_extra_B=94685
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=4
#-----------
time=18038563556
mem_heap_B=88862771
mem_heap_extra_B=95213
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=5
#-----------
time=24384709542
mem_heap_B=91227427
mem_heap_extra_B=96021
mem_stacks_B=0
heap_tree=detailed
n2: 91227427 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 90472448 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 48447488 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 45170688 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 24027136 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n4: 24027136 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
      n1: 1048576 0x365BAE: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 1048576 0x363843: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 1048576 0x363843: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 1048576 0x36080B: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 1048576 0x35EAE3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 1048576 0x35D406: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 1048576 0x35C0E8: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 1048576 0x3495DA: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 1048576 0x3278ED: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 1048576 0x2F907E: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n1: 1048576 0x2F975A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                 n1: 1048576 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
                  n0: 1048576 0x2F8532: main (test_checkpoint.cpp:255)
      n1: 1048576 0x3662E1: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 1048576 0x3640EF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 1048576 0x3640EF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 1048576 0x3618AD: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 1048576 0x35F4CD: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 1048576 0x35DCBA: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 1048576 0x35C54D: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 1048576 0x34A9AE: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 1048576 0x3286BF: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n1: 1048576 0x2F9744: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                n1: 1048576 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
                 n0: 1048576 0x2F8532: main (test_checkpoint.cpp:255)
      n1: 917504 0x3661BB: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 917504 0x363FBF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 917504 0x363FBF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 917504 0x3616E5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 917504 0x35F40D: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 917504 0x35DC16: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 917504 0x35C49E: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 917504 0x34A6F5: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 917504 0x328135: ag::relu(ag::Value const&) (ops.cpp:71)
               n1: 917504 0x2F9798: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 917504 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
                 n0: 917504 0x2F8532: main (test_checkpoint.cpp:255)
    n2: 21143552 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 172032 in 2 places, all below massif's threshold (1.00%)
   n2: 1179648 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 1048576 0x349560: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:19)
     n1: 1048576 0x3278ED: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
      n1: 1048576 0x2F907E: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
       n1: 1048576 0x2F975A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
        n1: 1048576 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
         n0: 1048576 0x2F8532: main (test_checkpoint.cpp:255)
    n0: 131072 in 1 place, below massif's threshold (1.00%)
   n1: 1048576 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 1048576 0x34A934: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:145)
     n1: 1048576 0x3286BF: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
      n1: 1048576 0x2F9744: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
       n1: 1048576 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
        n0: 1048576 0x2F8532: main (test_checkpoint.cpp:255)
   n1: 917504 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 917504 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 917504 0x34A688: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 917504 0x328135: ag::relu(ag::Value const&) (ops.cpp:71)
       n1: 917504 0x2F9798: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
        n1: 917504 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
         n0: 917504 0x2F8532: main (test_checkpoint.cpp:255)
   n0: 131072 in 1 place, below massif's threshold (1.00%)
  n1: 42024960 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 42024960 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 21012480 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 21012480 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
    n2: 21012480 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 40960 in 1 place, below massif's threshold (1.00%)
 n0: 754979 in 64 places, all below massif's threshold (1.00%)
#-----------
snapshot=6
#-----------
time=28608893674
mem_heap_B=92672931
mem_heap_extra_B=96477
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=7
#-----------
time=34978085370
mem_heap_B=95300283
mem_heap_extra_B=97333
mem_stacks_B=0
heap_tree=detailed
n2: 95300283 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 94535680 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 52510720 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 47136768 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 25993216 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n4: 25993216 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
      n1: 1703936 0x365BAE: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 1703936 0x363843: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 1703936 0x363843: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 1703936 0x36080B: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 1703936 0x35EAE3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 1703936 0x35D406: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 1703936 0x35C0E8: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 1703936 0x3495DA: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 1703936 0x3278ED: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 1703936 0x2F907E: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n1: 1703936 0x2F975A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                 n1: 1703936 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
                  n0: 1703936 0x2F8532: main (test_checkpoint.cpp:255)
      n1: 1703936 0x3662E1: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 1703936 0x3640EF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 1703936 0x3640EF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 1703936 0x3618AD: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 1703936 0x35F4CD: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 1703936 0x35DCBA: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 1703936 0x35C54D: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 1703936 0x34A9AE: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 1703936 0x3286BF: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n1: 1703936 0x2F9744: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                n1: 1703936 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
                 n0: 1703936 0x2F8532: main (test_checkpoint.cpp:255)
      n1: 1572864 0x3661BB: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 1572864 0x363FBF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 1572864 0x363FBF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 1572864 0x3616E5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 1572864 0x35F40D: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 1572864 0x35DC16: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 1572864 0x35C49E: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 1572864 0x34A6F5: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 1572864 0x328135: ag::relu(ag::Value const&) (ops.cpp:71)
               n1: 1572864 0x2F9798: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 1572864 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
                 n0: 1572864 0x2F8532: main (test_checkpoint.cpp:255)
    n2: 21143552 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 172032 in 2 places, all below massif's threshold (1.00%)
   n2: 1835008 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 1703936 0x349560: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:19)
     n1: 1703936 0x3278ED: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
      n1: 1703936 0x2F907E: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
       n1: 1703936 0x2F975A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
        n1: 1703936 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
         n0: 1703936 0x2F8532: main (test_checkpoint.cpp:255)
    n0: 131072 in 1 place, below massif's threshold (1.00%)
   n1: 1703936 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 1703936 0x34A934: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:145)
     n1: 1703936 0x3286BF: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
      n1: 1703936 0x2F9744: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
       n1: 1703936 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
        n0: 1703936 0x2F8532: main (test_checkpoint.cpp:255)
   n1: 1703936 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 1703936 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 1703936 0x34A688: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 1703936 0x328135: ag::relu(ag::Value const&) (ops.cpp:71)
       n1: 1703936 0x2F9798: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
        n1: 1703936 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
         n0: 1703936 0x2F8532: main (test_checkpoint.cpp:255)
   n0: 131072 in 1 place, below massif's threshold (1.00%)
  n1: 42024960 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 42024960 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 21012480 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 21012480 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
    n2: 21012480 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 40960 in 1 place, below massif's threshold (1.00%)
 n0: 764603 in 64 places, all below massif's threshold (1.00%)
#-----------
snapshot=8
#-----------
time=39235324597
mem_heap_B=96614731
mem_heap_extra_B=97797
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=9
#-----------
time=45575993125
mem_heap_B=98979811
mem_heap_extra_B=98589
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=10
#-----------
time=49694033563
mem_heap_B=100556531
mem_heap_extra_B=99117
mem_stacks_B=0
heap_tree=detailed
n2: 100556531 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 99778560 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 57753600 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n2: 49889280 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 28745728 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n4: 28745728 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x365BAE: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 2621440 0x363843: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 2621440 0x363843: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 2621440 0x36080B: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 2621440 0x35EAE3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35D406: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 2621440 0x35C0E8: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 2621440 0x3495DA: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 2621440 0x3278ED: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 2621440 0x2F907E: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n1: 2621440 0x2F975A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                 n1: 2621440 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
                  n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
      n1: 2621440 0x3662E1: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 2621440 0x3640EF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 2621440 0x3640EF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 2621440 0x3618AD: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 2621440 0x35F4CD: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35DCBA: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 2621440 0x35C54D: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 2621440 0x34A9AE: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 2621440 0x3286BF: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n1: 2621440 0x2F9744: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                n1: 2621440 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
                 n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
      n1: 2490368 0x3661BB: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 2490368 0x363FBF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 2490368 0x363FBF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 2490368 0x3616E5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 2490368 0x35F40D: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 2490368 0x35DC16: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 2490368 0x35C49E: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 2490368 0x34A6F5: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 2490368 0x328135: ag::relu(ag::Value const&) (ops.cpp:71)
               n1: 2490368 0x2F9798: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 2490368 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
                 n0: 2490368 0x2F8532: main (test_checkpoint.cpp:255)
    n2: 21143552 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 172032 in 2 places, all below massif's threshold (1.00%)
   n2: 2621440 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 2621440 0x349560: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:19)
     n1: 2621440 0x3278ED: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
      n1: 2621440 0x2F907E: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
       n1: 2621440 0x2F975A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
        n1: 2621440 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
         n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
    n0: 0 in 1 place, below massif's threshold (1.00%)
   n1: 2621440 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 2621440 0x34A934: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:145)
     n1: 2621440 0x3286BF: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
      n1: 2621440 0x2F9744: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
       n1: 2621440 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
        n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
   n1: 2490368 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 2490368 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 2490368 0x34A688: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:125)
      n1: 2490368 0x328135: ag::relu(ag::Value const&) (ops.cpp:71)
       n1: 2490368 0x2F9798: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
        n1: 2490368 0x2F7A84: run_memory_savings_test() (test_checkpoint.cpp:165)
         n0: 2490368 0x2F8532: main (test_checkpoint.cpp:255)
   n0: 131072 in 1 place, below massif's threshold (1.00%)
  n1: 42024960 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 42024960 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 21012480 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 21012480 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
    n2: 21012480 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 40960 in 1 place, below massif's threshold (1.00%)
 n0: 777971 in 64 places, all below massif's threshold (1.00%)
#-----------
snapshot=11
#-----------
time=53885816526
mem_heap_B=85840467
mem_heap_extra_B=94189
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=12
#-----------
time=58258498765
mem_heap_B=87942771
mem_heap_extra_B=94893
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=13
#-----------
time=62374509740
mem_heap_B=88993923
mem_heap_extra_B=95285
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=14
#-----------
time=66605315708
mem_heap_B=90570659
mem_heap_extra_B=95837
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=15
#-----------
time=70972633633
mem_heap_B=92672963
mem_heap_extra_B=96525
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=16
#-----------
time=77315539675
mem_heap_B=95038059
mem_heap_extra_B=97373
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=17
#-----------
time=81518462075
mem_heap_B=96614795
mem_heap_extra_B=97909
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=18
#-----------
time=87869920099
mem_heap_B=98979891
mem_heap_extra_B=98741
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=19
#-----------
time=92627155400
mem_heap_B=94006859
mem_heap_extra_B=98301
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=20
#-----------
time=96691505047
mem_heap_B=94138747
mem_heap_extra_B=98461
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=21
#-----------
time=100995597160
mem_heap_B=94401523
mem_heap_extra_B=98589
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=22
#-----------
time=105131823574
mem_heap_B=95060891
mem_heap_extra_B=99117
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=23
#-----------
time=109160094329
mem_heap_B=96107419
mem_heap_extra_B=99085
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=24
#-----------
time=111570333871
mem_heap_B=95189883
mem_heap_extra_B=99053
mem_stacks_B=0
heap_tree=detailed
n2: 95189883 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 94404736 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n3: 52379776 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n3: 50020480 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 28876800 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n5: 28876800 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x365BAE: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 2621440 0x363843: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 2621440 0x363843: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 2621440 0x36080B: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 2621440 0x35EAE3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35D406: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 2621440 0x35C0E8: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 2621440 0x3495DA: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 2621440 0x3278ED: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 2621440 0x2F907E: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 2621440 0x2F975A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                 n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                  n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x3661BB: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 2621440 0x363FBF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 2621440 0x363FBF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 2621440 0x3616E5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 2621440 0x35F40D: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35DC16: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 2621440 0x35C49E: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 2621440 0x34A6F5: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 2621440 0x328135: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 2621440 0x2F9798: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                 n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x3662E1: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 2621440 0x3640EF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 2621440 0x3640EF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 2621440 0x3618AD: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 2621440 0x35F4CD: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35DCBA: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 2621440 0x35C54D: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 2621440 0x34A9AE: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 2621440 0x3286BF: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 2621440 0x2F9744: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                 n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 21143552 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 172032 in 2 places, all below massif's threshold (1.00%)
    n0: 128 in 2 places, all below massif's threshold (1.00%)
   n0: 1179648 in 6 places, all below massif's threshold (1.00%)
   n1: 1179648 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 1179648 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n0: 1179648 in 3 places, all below massif's threshold (1.00%)
  n1: 42024960 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 42024960 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 21012480 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 21012480 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
    n2: 21012480 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 40960 in 1 place, below massif's threshold (1.00%)
 n0: 785147 in 72 places, all below massif's threshold (1.00%)
#-----------
snapshot=25
#-----------
time=115920835046
mem_heap_B=95189883
mem_heap_extra_B=99053
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=26
#-----------
time=120063556019
mem_heap_B=95189875
mem_heap_extra_B=99085
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=27
#-----------
time=124232703961
mem_heap_B=95978483
mem_heap_extra_B=99517
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=28
#-----------
time=128369578442
mem_heap_B=97158811
mem_heap_extra_B=99661
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=29
#-----------
time=132695178871
mem_heap_B=97158811
mem_heap_extra_B=99661
mem_stacks_B=0
heap_tree=detailed
n2: 97158811 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 96370816 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n4: 54345856 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n3: 50020480 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 28876800 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n5: 28876800 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x365BAE: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 2621440 0x363843: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 2621440 0x363843: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 2621440 0x36080B: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 2621440 0x35EAE3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35D406: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 2621440 0x35C0E8: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 2621440 0x3495DA: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 2621440 0x3278ED: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 2621440 0x2F907E: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 2621440 0x2F975A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                 n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                  n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x3661BB: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 2621440 0x363FBF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 2621440 0x363FBF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 2621440 0x3616E5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 2621440 0x35F40D: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35DC16: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 2621440 0x35C49E: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 2621440 0x34A6F5: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 2621440 0x328135: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 2621440 0x2F9798: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                 n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x3662E1: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 2621440 0x3640EF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 2621440 0x3640EF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 2621440 0x3618AD: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 2621440 0x35F4CD: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35DCBA: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 2621440 0x35C54D: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 2621440 0x34A9AE: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 2621440 0x3286BF: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 2621440 0x2F9744: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                 n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 21143552 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 172032 in 2 places, all below massif's threshold (1.00%)
    n0: 128 in 2 places, all below massif's threshold (1.00%)
   n2: 1966080 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 1048576 0x342EBD: ag::detail::vjp_MatMul(ag::Node*, OwnTensor::Tensor const&) (autodiff_vjp_ops.cpp:545)
     n1: 1048576 0x31EFB4: ag::backward(ag::Value const&, OwnTensor::Tensor const*, bool) (autodiff.cpp:89)
      n1: 1048576 0x2F8287: run_memory_savings_test() (test_checkpoint.cpp:246)
       n0: 1048576 0x2F8532: main (test_checkpoint.cpp:255)
    n0: 917504 in 3 places, all below massif's threshold (1.00%)
   n1: 1441792 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 1441792 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n0: 1441792 in 3 places, all below massif's threshold (1.00%)
   n0: 917504 in 5 places, all below massif's threshold (1.00%)
  n1: 42024960 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 42024960 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 21012480 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 21012480 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
    n2: 21012480 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 40960 in 1 place, below massif's threshold (1.00%)
 n0: 787995 in 72 places, all below massif's threshold (1.00%)
#-----------
snapshot=30
#-----------
time=135096836985
mem_heap_B=96241275
mem_heap_extra_B=99645
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=31
#-----------
time=139238445228
mem_heap_B=96241267
mem_heap_extra_B=99645
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=32
#-----------
time=143385556348
mem_heap_B=97029619
mem_heap_extra_B=100093
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=33
#-----------
time=147531605082
mem_heap_B=98209947
mem_heap_extra_B=100253
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=34
#-----------
time=151861136164
mem_heap_B=98209947
mem_heap_extra_B=100253
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=35
#-----------
time=154252979540
mem_heap_B=97292411
mem_heap_extra_B=100237
mem_stacks_B=0
heap_tree=detailed
n2: 97292411 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 96501888 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 54476928 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n3: 50020480 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 28876800 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n5: 28876800 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x365BAE: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 2621440 0x363843: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 2621440 0x363843: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 2621440 0x36080B: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 2621440 0x35EAE3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35D406: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 2621440 0x35C0E8: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 2621440 0x3495DA: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 2621440 0x3278ED: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 2621440 0x2F907E: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 2621440 0x2F975A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                 n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                  n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x3661BB: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 2621440 0x363FBF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 2621440 0x363FBF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 2621440 0x3616E5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 2621440 0x35F40D: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35DC16: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 2621440 0x35C49E: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 2621440 0x34A6F5: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 2621440 0x328135: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 2621440 0x2F9798: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                 n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x3662E1: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 2621440 0x3640EF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 2621440 0x3640EF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 2621440 0x3618AD: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 2621440 0x35F4CD: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35DCBA: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 2621440 0x35C54D: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 2621440 0x34A9AE: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 2621440 0x3286BF: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 2621440 0x2F9744: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                 n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 21143552 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 172032 in 2 places, all below massif's threshold (1.00%)
    n0: 128 in 2 places, all below massif's threshold (1.00%)
   n1: 1703936 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n1: 1703936 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n0: 1703936 in 3 places, all below massif's threshold (1.00%)
   n2: 1441792 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 1310720 0x32B940: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:361)
     n1: 1310720 0x32C7EC: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n1: 1310720 0x3053E9: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n1: 1310720 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
        n0: 1310720 in 2 places, all below massif's threshold (1.00%)
    n0: 131072 in 3 places, all below massif's threshold (1.00%)
   n2: 1310720 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 1310720 0x32B7C3: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:350)
     n1: 1310720 0x32C7EC: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n1: 1310720 0x3053E9: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n0: 1310720 in 2 places, all below massif's threshold (1.00%)
    n0: 0 in 4 places, all below massif's threshold (1.00%)
   n0: 0 in 4 places, all below massif's threshold (1.00%)
  n1: 42024960 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 42024960 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 21012480 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 21012480 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
    n2: 21012480 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 40960 in 1 place, below massif's threshold (1.00%)
 n0: 790523 in 72 places, all below massif's threshold (1.00%)
#-----------
snapshot=36
#-----------
time=158428536601
mem_heap_B=97292403
mem_heap_extra_B=100237
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=37
#-----------
time=162558134353
mem_heap_B=98081235
mem_heap_extra_B=100653
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=38
#-----------
time=166737925846
mem_heap_B=99261563
mem_heap_extra_B=100813
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=39
#-----------
time=169126390466
mem_heap_B=98344027
mem_heap_extra_B=100797
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=40
#-----------
time=173432940772
mem_heap_B=98344027
mem_heap_extra_B=100797
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=41
#-----------
time=177642365416
mem_heap_B=98344019
mem_heap_extra_B=100797
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=42
#-----------
time=181806275237
mem_heap_B=99132371
mem_heap_extra_B=101245
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=43
#-----------
time=185928256440
mem_heap_B=100312699
mem_heap_extra_B=101405
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=44
#-----------
time=190267777466
mem_heap_B=100312699
mem_heap_extra_B=101405
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=45
#-----------
time=192654843713
mem_heap_B=99395163
mem_heap_extra_B=101389
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=46
#-----------
time=196793514283
mem_heap_B=99395155
mem_heap_extra_B=101389
mem_stacks_B=0
heap_tree=detailed
n2: 99395155 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 98599040 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 56574080 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n3: 50020480 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 28876800 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n5: 28876800 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x365BAE: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 2621440 0x363843: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 2621440 0x363843: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 2621440 0x36080B: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 2621440 0x35EAE3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35D406: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 2621440 0x35C0E8: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 2621440 0x3495DA: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 2621440 0x3278ED: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 2621440 0x2F907E: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 2621440 0x2F975A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                 n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                  n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x3661BB: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 2621440 0x363FBF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 2621440 0x363FBF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 2621440 0x3616E5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 2621440 0x35F40D: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35DC16: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 2621440 0x35C49E: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 2621440 0x34A6F5: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 2621440 0x328135: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 2621440 0x2F9798: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                 n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x3662E1: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 2621440 0x3640EF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 2621440 0x3640EF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 2621440 0x3618AD: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 2621440 0x35F4CD: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35DCBA: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 2621440 0x35C54D: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 2621440 0x34A9AE: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 2621440 0x3286BF: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 2621440 0x2F9744: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                 n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 21143552 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 172032 in 2 places, all below massif's threshold (1.00%)
    n0: 128 in 2 places, all below massif's threshold (1.00%)
   n2: 2228224 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 2228224 0x32B940: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:361)
     n1: 2228224 0x32C7EC: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n1: 2228224 0x3053E9: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n2: 2228224 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
        n1: 1441792 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
         n1: 1441792 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
          n1: 1441792 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
           n0: 1441792 in 2 places, all below massif's threshold (1.00%)
        n0: 786432 in 1 place, below massif's threshold (1.00%)
    n0: 0 in 3 places, all below massif's threshold (1.00%)
   n1: 2228224 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n2: 2228224 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 1310720 0x32B9DE: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:370)
      n1: 1310720 0x32C7EC: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
       n1: 1310720 0x3053E9: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
        n1: 1310720 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
         n1: 1310720 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
          n0: 1310720 in 2 places, all below massif's threshold (1.00%)
     n0: 917504 in 2 places, all below massif's threshold (1.00%)
   n2: 2097152 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 2097152 0x32B7C3: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:350)
     n1: 2097152 0x32C7EC: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n2: 2097152 0x3053E9: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n1: 1310720 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
        n1: 1310720 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
         n1: 1310720 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
          n0: 1310720 in 2 places, all below massif's threshold (1.00%)
       n0: 786432 in 1 place, below massif's threshold (1.00%)
    n0: 0 in 4 places, all below massif's threshold (1.00%)
   n0: 0 in 4 places, all below massif's threshold (1.00%)
  n1: 42024960 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 42024960 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 21012480 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 21012480 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
    n2: 21012480 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 40960 in 1 place, below massif's threshold (1.00%)
 n0: 796115 in 72 places, all below massif's threshold (1.00%)
#-----------
snapshot=47
#-----------
time=203015615054
mem_heap_B=100577683
mem_heap_extra_B=102061
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=48
#-----------
time=205198540670
mem_heap_B=101758011
mem_heap_extra_B=102221
mem_stacks_B=0
heap_tree=peak
n2: 101758011 (heap allocation functions) malloc/new/new[], --alloc-fns, etc.
 n2: 100958336 0x581C73B: OwnTensor::CPUAllocator::allocate(unsigned long) (CPUAllocator.cpp:12)
  n5: 58933376 0x55C20CE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:126)
   n3: 50020480 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 28876800 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n5: 28876800 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x365BAE: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (stl_construct.h:119)
       n1: 2621440 0x363843: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[2]> (alloc_traits.h:661)
        n1: 2621440 0x363843: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:604)
         n1: 2621440 0x36080B: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:971)
          n1: 2621440 0x35EAE3: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35D406: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:464)
            n1: 2621440 0x35C0E8: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [2]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [2]) (shared_ptr.h:1010)
             n1: 2621440 0x3495DA: ag::detail::add_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:21)
              n1: 2621440 0x3278ED: ag::add(ag::Value const&, ag::Value const&) (ops.cpp:17)
               n1: 2621440 0x2F907E: ag::operator+(ag::Value const&, ag::Value const&) (ops.hpp:28)
                n2: 2621440 0x2F975A: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                 n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                  n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                 n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x3661BB: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (stl_construct.h:119)
       n1: 2621440 0x363FBF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[5]> (alloc_traits.h:661)
        n1: 2621440 0x363FBF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:604)
         n1: 2621440 0x3616E5: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:971)
          n1: 2621440 0x35F40D: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35DC16: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:464)
            n1: 2621440 0x35C49E: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [5]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [5]) (shared_ptr.h:1010)
             n1: 2621440 0x34A6F5: ag::detail::relu_nodeops(std::shared_ptr<ag::Node> const&) (activation.cpp:128)
              n1: 2621440 0x328135: ag::relu(ag::Value const&) (ops.cpp:71)
               n2: 2621440 0x2F9798: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:120)
                n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                 n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n1: 2621440 0x3662E1: void std::_Construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (stl_construct.h:119)
       n1: 2621440 0x3640EF: construct<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&)[7]> (alloc_traits.h:661)
        n1: 2621440 0x3640EF: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::allocator<void>, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:604)
         n1: 2621440 0x3618AD: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:971)
          n1: 2621440 0x35F4CD: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr_base.h:1712)
           n1: 2621440 0x35DCBA: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:464)
            n1: 2621440 0x35C54D: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor&, ag::Op, bool, char const (&) [7]>(OwnTensor::Tensor&, ag::Op&&, bool&&, char const (&) [7]) (shared_ptr.h:1010)
             n1: 2621440 0x34A9AE: ag::detail::matmul_nodeops(std::shared_ptr<ag::Node> const&, std::shared_ptr<ag::Node> const&) (activation.cpp:149)
              n1: 2621440 0x3286BF: ag::matmul(ag::Value const&, ag::Value const&) (ops.cpp:113)
               n2: 2621440 0x2F9744: DeepModel::forward(ag::Value, bool) (test_checkpoint.cpp:119)
                n1: 2621440 0x2F7BBF: run_memory_savings_test() (test_checkpoint.cpp:182)
                 n0: 2621440 0x2F8532: main (test_checkpoint.cpp:255)
                n0: 0 in 1 place, below massif's threshold (1.00%)
      n0: 0 in 1 place, below massif's threshold (1.00%)
    n2: 21143552 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 172032 in 2 places, all below massif's threshold (1.00%)
    n0: 128 in 2 places, all below massif's threshold (1.00%)
   n3: 3670016 0x55E0529: OwnTensor::matmul(OwnTensor::Tensor const&, OwnTensor::Tensor const&, CUstream_st*) (GenMatmul.cpp:87)
    n1: 2621440 0x32B940: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:361)
     n1: 2621440 0x32C7EC: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n1: 2621440 0x3053E9: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n2: 2621440 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
        n1: 1703936 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
         n1: 1703936 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
          n1: 1703936 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
           n0: 1703936 in 2 places, all below massif's threshold (1.00%)
        n0: 917504 in 1 place, below massif's threshold (1.00%)
    n1: 1048576 0x342EBD: ag::detail::vjp_MatMul(ag::Node*, OwnTensor::Tensor const&) (autodiff_vjp_ops.cpp:545)
     n1: 1048576 0x31EFB4: ag::backward(ag::Value const&, OwnTensor::Tensor const*, bool) (autodiff.cpp:89)
      n1: 1048576 0x2F8287: run_memory_savings_test() (test_checkpoint.cpp:246)
       n0: 1048576 0x2F8532: main (test_checkpoint.cpp:255)
    n0: 0 in 2 places, all below massif's threshold (1.00%)
   n2: 2621440 0x5514AEF: OwnTensor::operator+(OwnTensor::Tensor const&, OwnTensor::Tensor const&) (TensorOps.cpp:46)
    n1: 2621440 0x32B7C3: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:350)
     n1: 2621440 0x32C7EC: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
      n2: 2621440 0x3053E9: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
       n1: 1703936 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
        n1: 1703936 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
         n1: 1703936 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
          n0: 1703936 in 2 places, all below massif's threshold (1.00%)
       n0: 917504 in 1 place, below massif's threshold (1.00%)
    n0: 0 in 4 places, all below massif's threshold (1.00%)
   n1: 2621440 0x583473E: OwnTensor::cpu_mul_copy(OwnTensor::Tensor const&, double) (ScalarOps.cpp:180)
    n2: 2621440 0x5821D7A: OwnTensor::Tensor OwnTensor::operator*<float>(OwnTensor::Tensor const&, float) (ScalarOpsDispatcher.cpp:132)
     n1: 1703936 0x32B9DE: ag::forward_eval_node(std::shared_ptr<ag::Node> const&) (ops.cpp:370)
      n1: 1703936 0x32C7EC: ag::forward_eval_node(ag::Node*) (ops.cpp:537)
       n1: 1703936 0x3053E9: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:216)
        n1: 1703936 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
         n1: 1703936 0x305108: ag::checkpoint_impl::recompute_subgraph(std::shared_ptr<ag::Node> const&) (checkpoint.cpp:188)
          n0: 1703936 in 2 places, all below massif's threshold (1.00%)
     n0: 917504 in 2 places, all below massif's threshold (1.00%)
   n0: 0 in 4 places, all below massif's threshold (1.00%)
  n1: 42024960 0x55C21EE: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::Dtype, OwnTensor::DeviceIndex, bool) (Tensor.cpp:146)
   n2: 42024960 0x55C253D: OwnTensor::Tensor::Tensor(OwnTensor::Shape, OwnTensor::TensorOptions) (Tensor.cpp:176)
    n1: 21012480 0x55A9085: OwnTensor::Tensor::zeros(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:51)
     n1: 21012480 0x3264BA: ag::Node::Node(OwnTensor::Tensor const&, ag::Op, bool, char const*) (graph.cpp:35)
      n1: 21012480 0x2FEAFA: void std::_Construct<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (stl_construct.h:119)
       n1: 21012480 0x2FDA8B: construct<ag::Node, const OwnTensor::Tensor&, ag::Op, bool, char const*&> (alloc_traits.h:661)
        n1: 21012480 0x2FDA8B: std::_Sp_counted_ptr_inplace<ag::Node, std::allocator<void>, (__gnu_cxx::_Lock_policy)2>::_Sp_counted_ptr_inplace<OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::allocator<void>, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:604)
         n1: 21012480 0x2FCF63: std::__shared_count<(__gnu_cxx::_Lock_policy)2>::__shared_count<ag::Node, std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(ag::Node*&, std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:971)
          n1: 21012480 0x2FBF61: std::__shared_ptr<ag::Node, (__gnu_cxx::_Lock_policy)2>::__shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr_base.h:1712)
           n1: 21012480 0x2FB2C2: std::shared_ptr<ag::Node>::shared_ptr<std::allocator<void>, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(std::_Sp_alloc_shared_tag<std::allocator<void> >, OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:464)
            n1: 21012480 0x2FA5FA: std::shared_ptr<ag::Node> std::make_shared<ag::Node, OwnTensor::Tensor const&, ag::Op, bool, char const*&>(OwnTensor::Tensor const&, ag::Op&&, bool&&, char const*&) (shared_ptr.h:1010)
             n2: 21012480 0x2F8EBA: ag::make_tensor(OwnTensor::Tensor const&, char const*) (graph.hpp:69)
              n1: 20971520 0x2F9352: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
               n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
                n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
              n0: 40960 in 1 place, below massif's threshold (1.00%)
    n2: 21012480 0x55AF3E2: OwnTensor::Tensor::randn(OwnTensor::Shape, OwnTensor::TensorOptions) (TensorFactory.cpp:205)
     n1: 20971520 0x2F9332: DeepModel::DeepModel(int, int) (test_checkpoint.cpp:111)
      n1: 20971520 0x2F7927: run_memory_savings_test() (test_checkpoint.cpp:156)
       n0: 20971520 0x2F8532: main (test_checkpoint.cpp:255)
     n0: 40960 in 1 place, below massif's threshold (1.00%)
 n0: 799675 in 72 places, all below massif's threshold (1.00%)
#-----------
snapshot=49
#-----------
time=211513801244
mem_heap_B=101758011
mem_heap_extra_B=102221
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=50
#-----------
time=213910759645
mem_heap_B=100840475
mem_heap_extra_B=102205
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=51
#-----------
time=216129504211
mem_heap_B=100971579
mem_heap_extra_B=102221
mem_stacks_B=0
heap_tree=empty
#-----------
snapshot=52
#-----------
time=218313913803
mem_heap_B=100707227
mem_heap_extra_B=102133
mem_stacks_B=0
heap_tree=empty
