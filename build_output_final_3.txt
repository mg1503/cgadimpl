== Build Type:    Debug
== Using CUDA CXX: /usr/local/cuda-13.0/bin/nvcc
== Building tensor library


✅ Library build is up-to-date.
== Configuring core
-- Found OwnTensor headers: /home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include
-- Found OwnTensor library: /home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/lib/libtensor.so
-- Forcing NovaCompiler include dir: /home/blubridge-029/Downloads/cgad/cgadimpl_/Nova-Compiler/install/include
-- cgadimpl build mode: Debug
-- Configuring done (0.0s)
-- Generating done (0.1s)
-- Build files have been written to: /home/blubridge-029/Downloads/cgad/cgadimpl_/cgadimpl/build
== Building core
[  1%] Building CXX object CMakeFiles/cgadimpl.dir/src/autodiff/autodiff_vjp_ops.cpp.o
/home/blubridge-029/Downloads/cgad/cgadimpl_/cgadimpl/src/autodiff/autodiff_vjp_ops.cpp: In function ‘void ag::detail::vjp_LayerNorm(ag::Node*, const OwnTensor::Tensor&)’:
/home/blubridge-029/Downloads/cgad/cgadimpl_/cgadimpl/src/autodiff/autodiff_vjp_ops.cpp:337:52: error: no match for ‘operator-’ (operand type is ‘OwnTensor::Tensor’)
  337 |         Tensor d_mean = OwnTensor::reduce_sum(gy * -std_inv, {-1}, true) + d_var * OwnTensor::reduce_sum((x - mean) * -2.0f, {-1}, true) / static_cast<float>(D);
      |                                                    ^~~~~~~~
In file included from /home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/TensorLib.h:24,
                 from /home/blubridge-029/Downloads/cgad/cgadimpl_/cgadimpl/include/tensor.hpp:6,
                 from /home/blubridge-029/Downloads/cgad/cgadimpl_/cgadimpl/include/ad/core/graph.hpp:10,
                 from /home/blubridge-029/Downloads/cgad/cgadimpl_/cgadimpl/include/ad/detail/autodiff_ops.hpp:9,
                 from /home/blubridge-029/Downloads/cgad/cgadimpl_/cgadimpl/src/autodiff/autodiff_vjp_ops.cpp:5:
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/ops/ScalarOps.h:14:29: note: candidate: ‘template<class S> OwnTensor::Tensor OwnTensor::operator-(const Tensor&, S)’
   14 | template<typename S> Tensor operator-(const Tensor& tensor, S scalar);
      |                             ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/ops/ScalarOps.h:14:29: note:   template argument deduction/substitution failed:
/home/blubridge-029/Downloads/cgad/cgadimpl_/cgadimpl/src/autodiff/autodiff_vjp_ops.cpp:337:53: note:   candidate expects 2 arguments, 1 provided
  337 |         Tensor d_mean = OwnTensor::reduce_sum(gy * -std_inv, {-1}, true) + d_var * OwnTensor::reduce_sum((x - mean) * -2.0f, {-1}, true) / static_cast<float>(D);
      |                                                     ^~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/ops/ScalarOps.h:20:29: note: candidate: ‘template<class S> OwnTensor::Tensor OwnTensor::operator-(S, const Tensor&)’
   20 | template<typename S> Tensor operator-(S scalar, const Tensor& tensor);
      |                             ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/ops/ScalarOps.h:20:29: note:   template argument deduction/substitution failed:
/home/blubridge-029/Downloads/cgad/cgadimpl_/cgadimpl/src/autodiff/autodiff_vjp_ops.cpp:337:53: note:   candidate expects 2 arguments, 1 provided
  337 |         Tensor d_mean = OwnTensor::reduce_sum(gy * -std_inv, {-1}, true) + d_var * OwnTensor::reduce_sum((x - mean) * -2.0f, {-1}, true) / static_cast<float>(D);
      |                                                     ^~~~~~~
In file included from /home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/core/Tensor.h:7,
                 from /home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/TensorLib.h:6:
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:905:44: note: candidate: ‘OwnTensor::complex32_t OwnTensor::operator-(float, const complex32_t&)’
  905 |     __device__ __host__ inline complex32_t operator-(float s, const complex32_t& c) { return complex32_t(s) - c; }
      |                                            ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:905:44: note:   candidate expects 2 arguments, 1 provided
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:906:44: note: candidate: ‘OwnTensor::complex32_t OwnTensor::operator-(const complex32_t&, float)’
  906 |     __device__ __host__ inline complex32_t operator-(const complex32_t& c, float s) { return c - complex32_t(s); }
      |                                            ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:906:44: note:   candidate expects 2 arguments, 1 provided
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:914:44: note: candidate: ‘OwnTensor::complex32_t OwnTensor::operator-(double, const complex32_t&)’
  914 |     __device__ __host__ inline complex32_t operator-(double s, const complex32_t& c) { return complex32_t(s) - c; }
      |                                            ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:914:44: note:   candidate expects 2 arguments, 1 provided
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:915:44: note: candidate: ‘OwnTensor::complex32_t OwnTensor::operator-(const complex32_t&, double)’
  915 |     __device__ __host__ inline complex32_t operator-(const complex32_t& c, double s) { return c - complex32_t(s); }
      |                                            ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:915:44: note:   candidate expects 2 arguments, 1 provided
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:924:44: note: candidate: ‘OwnTensor::complex64_t OwnTensor::operator-(float, const complex64_t&)’
  924 |     __device__ __host__ inline complex64_t operator-(float s, const complex64_t& c) { return complex64_t(s) - c; }
      |                                            ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:924:44: note:   candidate expects 2 arguments, 1 provided
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:925:44: note: candidate: ‘OwnTensor::complex64_t OwnTensor::operator-(const complex64_t&, float)’
  925 |     __device__ __host__ inline complex64_t operator-(const complex64_t& c, float s) { return c - complex64_t(s); }
      |                                            ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:925:44: note:   candidate expects 2 arguments, 1 provided
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:933:44: note: candidate: ‘OwnTensor::complex64_t OwnTensor::operator-(double, const complex64_t&)’
  933 |     __device__ __host__ inline complex64_t operator-(double s, const complex64_t& c) { return complex64_t(s) - c; }
      |                                            ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:933:44: note:   candidate expects 2 arguments, 1 provided
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:934:44: note: candidate: ‘OwnTensor::complex64_t OwnTensor::operator-(const complex64_t&, double)’
  934 |     __device__ __host__ inline complex64_t operator-(const complex64_t& c, double s) { return c - complex64_t(s); }
      |                                            ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:934:44: note:   candidate expects 2 arguments, 1 provided
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:943:45: note: candidate: ‘OwnTensor::complex128_t OwnTensor::operator-(float, const complex128_t&)’
  943 |     __device__ __host__ inline complex128_t operator-(float s, const complex128_t& c) { return complex128_t(s) - c; }
      |                                             ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:943:45: note:   candidate expects 2 arguments, 1 provided
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:944:45: note: candidate: ‘OwnTensor::complex128_t OwnTensor::operator-(const complex128_t&, float)’
  944 |     __device__ __host__ inline complex128_t operator-(const complex128_t& c, float s) { return c - complex128_t(s); }
      |                                             ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:944:45: note:   candidate expects 2 arguments, 1 provided
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:952:45: note: candidate: ‘OwnTensor::complex128_t OwnTensor::operator-(double, const complex128_t&)’
  952 |     __device__ __host__ inline complex128_t operator-(double s, const complex128_t& c) { return complex128_t(s) - c; }
      |                                             ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:952:45: note:   candidate expects 2 arguments, 1 provided
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:953:45: note: candidate: ‘OwnTensor::complex128_t OwnTensor::operator-(const complex128_t&, double)’
  953 |     __device__ __host__ inline complex128_t operator-(const complex128_t& c, double s) { return c - complex128_t(s); }
      |                                             ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/dtype/Types.h:953:45: note:   candidate expects 2 arguments, 1 provided
In file included from /home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/TensorLib.h:25:
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/ops/TensorOps.h:6:12: note: candidate: ‘OwnTensor::Tensor OwnTensor::operator-(const Tensor&, const Tensor&)’
    6 |     Tensor operator-(const Tensor& lhs, const Tensor& rhs);
      |            ^~~~~~~~
/home/blubridge-029/Downloads/cgad/cgadimpl_/tensor/include/ops/TensorOps.h:6:12: note:   candidate expects 2 arguments, 1 provided
gmake[2]: *** [CMakeFiles/cgadimpl.dir/build.make:90: CMakeFiles/cgadimpl.dir/src/autodiff/autodiff_vjp_ops.cpp.o] Error 1
gmake[1]: *** [CMakeFiles/Makefile2:388: CMakeFiles/cgadimpl.dir/all] Error 2
gmake: *** [Makefile:101: all] Error 2
